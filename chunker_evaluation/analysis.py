import json
import os
def count_chunks(output_dir):
    """
    Counts the number of chunks generated by each chunker for each document.

    Parameters
    ----------
    output_dir : str
        Path to the directory where the generated data is saved.

    Returns
    -------
    pd.DataFrame
        A DataFrame with chunkers as rows and documents as columns,
        containing the number of chunks generated.
    """
    data = {}

    for chunker_name in os.listdir(output_dir):
        chunker_dir = os.path.join(output_dir, chunker_name)
        if os.path.isdir(chunker_dir):
            data[chunker_name] = {}
            for filename in os.listdir(chunker_dir):
                if filename.endswith("_qa_dataset.json"):
                    filepath = os.path.join(chunker_dir, filename)
                    with open(filepath, "r") as f:
                        qa_dataset = json.load(f)
                        num_chunks = len(
                            qa_dataset
                        )  # Assuming one chunk per question-answer pair
                        data[chunker_name][filename] = num_chunks

    # Create a pandas DataFrame from the data
    df = pd.DataFrame(data).T.fillna(0).astype(int)
    df.index.name = "Chunker"
    df.columns = [col.replace("_qa_dataset.json", "") for col in df.columns]

    return df
